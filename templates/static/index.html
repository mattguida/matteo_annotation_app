<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Annotation Interface</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 2rem;
    max-width: 600px;
    margin: auto;
    background: #f5f7fa;
    color: #333;
  }

  /* Instructions button styling */
  #instructions-btn {
    position: fixed;
    top: 15px;
    right: 15px;
    background: #2196f3;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    box-shadow: 0 3px 8px rgba(33, 150, 243, 0.4);
    transition: all 0.3s ease;
    z-index: 1000;
  }

  #instructions-btn:hover {
    background: #1976d2;
    transform: translateY(-2px);
    box-shadow: 0 5px 12px rgba(33, 150, 243, 0.6);
  }

  /* Modal styles */
  #modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
  }

  #modal-content {
    background-color: #f9f9f9;
    margin: 2% auto;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow-y: auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #222;
    line-height: 1.6;
  }

  #close-btn {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    margin-top: -10px;
    margin-right: -10px;
  }

  #close-btn:hover {
    color: #000;
  }

  #modal h2 {
    color: #2c3e50;
    margin-bottom: 15px;
  }

  #modal h3 {
    color: #34495e;
    margin-top: 25px;
    margin-bottom: 15px;
    border-bottom: 2px solid #3498db;
    padding-bottom: 5px;
  }

  #modal p {
    margin-bottom: 12px;
    font-size: 16px;
  }

  #modal strong {
    color: #34495e;
  }

  /* Example styling */
  .example-container {
    background: #ffffff;
    border: 2px solid #3498db;
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }

  .example-sentence {
    background: #e8f4fd;
    padding: 15px;
    border-radius: 8px;
    font-style: italic;
    margin-bottom: 15px;
    border-left: 4px solid #3498db;
  }

  .example-labels {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin: 15px 0;
  }

  .example-label {
    padding: 6px 12px;
    border-radius: 15px;
    color: white;
    font-size: 12px;
    font-weight: 600;
  }

  .example-label.economic {
    background: #f9a825;
  }

  .example-label.legality-crime {
    background: #00796b;
  }

  .example-label.public-opinion {
    background: #e64a19;
  }

  .example-explanation {
    background: #f8f9fa;
    padding: 12px;
    border-radius: 6px;
    border-left: 3px solid #28a745;
    font-size: 14px;
    color: #495057;
  }

  #sentence {
    font-size: 1.4rem;
    font-weight: 600;
    min-height: 4rem;
    margin-bottom: 2.5rem;
    padding: 1.5rem 2.5rem;
    border: 2px solid #3f51b5;
    border-radius: 50px;
    background-color: #e8eaf6;
    text-align: center;
    max-width: 95%;
    margin-left: auto;
    margin-right: auto;
  }

  #labels {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
  }

  #labels > .none-container {
    grid-column: 1 / 4;
    display: flex;
    justify-content: center;
  }

  #labels input[type="checkbox"] {
    display: none;
  }

  #labels label {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 1.2rem 3rem 1.2rem 1.2rem;
    font-weight: 600;
    border-radius: 10px;
    user-select: none;
    color: white;
    box-shadow: 0 3px 6px rgba(0,0,0,0.1);
    transition: background 0.3s, color 0.3s, box-shadow 0.3s;
    font-size: 1.1rem;
    position: relative;
  }

  /* Tick box styling */
  #labels label::before {
    content: '';
    position: absolute;
    right: 10px;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255, 255, 255, 0.7);
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
  }

  /* Tick mark inside the box */
  #labels input[type="checkbox"]:checked + label::before {
    background: rgba(255, 255, 255, 0.9);
    border-color: rgba(255, 255, 255, 1);
  }

  #labels input[type="checkbox"]:checked + label::after {
    content: '‚úì';
    position: absolute;
    right: 13px;
    top: 50%;
    transform: translateY(-50%);
    color: #333;
    font-size: 12px;
    font-weight: bold;
  }

  label[for="Economic"] {
    background: #f9a825;
  }
  label[for="Legality_Crime"] {
    background: #00796b;
  }
  label[for="Health_Safety"] {
    background: #388e3c;
  }
  label[for="Fairness_Equality"] {
    background: #1976d2;
  }
  label[for="Security_Defense"] {
    background: #7b1fa2;
  }
  label[for="Public_Opinion"] {
    background: #e64a19;
  }
  label[for="Morality"] {
    background: #c2185b;
  }
  label[for="Political_Policies"] {
    background: #512da8;
  }
  label[for="Cultural_Identity"] {
    background: #0288d1;
  }

  label[for="None"] {
    background: #546e7a;
    width: 150px;
    justify-content: center;
  }

  #labels input[type="checkbox"]:checked + label {
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    filter: brightness(1.3);
    color: #fff !important;
    font-weight: 700;
  }

  button {
    margin: 0.5rem 0.5rem 0 0;
    padding: 0.7rem 1.2rem;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: #3f51b5;
    color: white;
    box-shadow: 0 3px 6px rgba(0,0,0,0.2);
    transition: background 0.3s ease;
  }
  button:hover {
    background: #303f9f;
  }

  #status {
    margin-top: 1rem;
    font-weight: 600;
    font-size: 1.1rem;
    min-height: 1.5rem;
  }

  #annotator-info {
    background: #e3f2fd;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: #1565c0;
  }

  .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.6);
      backdrop-filter: blur(5px);
      justify-content: center;
      align-items: center;
  }

  .name-input-content {
      background-color: #ffffff;
      padding: 40px;
      border-radius: 12px;
      width: 90%;
      max-width: 450px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      text-align: center;
      animation: modalFadeIn 0.3s;
  }

  @keyframes modalFadeIn {
      from {opacity: 0; transform: translateY(-50px);}
      to {opacity: 1; transform: translateY(0);}
  }

  .name-input-content h2 {
      color: #3f51b5;
      margin-bottom: 24px;
      font-size: 28px;
  }

  .name-input-content p {
      color: #555;
      margin-bottom: 24px;
      font-size: 18px;
  }

  #annotator-name {
      width: calc(100% - 24px);
      padding: 14px;
      margin: 10px 0 24px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.3s;
  }

  #annotator-name:focus {
      border-color: #3f51b5;
      outline: none;
  }

  .start-btn {
      background-color: #3f51b5;
      color: white;
      border: none;
      padding: 14px 28px;
      font-size: 18px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.1s;
  }

  .start-btn:hover {
      background-color: #303f9f;
  }

  .start-btn:active {
      transform: scale(0.98);
  }
  

</style>
</head>
<body>

<!-- Instructions button -->
<button id="instructions-btn" onclick="openModal()">üìã Instructions</button>

<!-- Name Input Modal -->
<div id="name-modal" class="modal">
    <div class="modal-content name-input-content">
        <h2>Welcome to the Annotation Interface!</h2>
        <p>Please enter your name to begin:</p>
        <input type="text" id="annotator-name" placeholder="Your Name">
        <button onclick="startAnnotation()" class="start-btn">Start Annotating</button>
    </div>
</div>

<!-- Modal for Framing Categories -->
<div id="modal">
  <div id="modal-content">
    <span id="close-btn" onclick="closeModal()">&times;</span>
    <h2>Framing Categories</h2>

    <p><strong>Economic</strong><br>
    Description: The costs, benefits, or monetary/financial implications of the issue (to an individual, family, community, or to the economy as a whole).<br>
    Example: Legalizing same-sex marriage would boost state economies through increased spending on weddings and tourism.</p>

    <p><strong>Morality</strong><br>
    Description: Any perspective‚Äîor policy objective or action (including proposed action)‚Äîthat is compelled by religious doctrine or interpretation, duty, honor, righteousness or any other sense of ethics or social responsibility.<br>
    Example: Same-sex marriage is morally wrong and goes against the teachings of our faith.</p>

    <p><strong>Fairness and Equality</strong><br>
    Description: Equality or inequality with which laws, punishment, rewards, and resources are applied or distributed among individuals or groups. Also the balance between the rights or interests of one individual or group compared to another individual or group.<br>
    Example: Denying same-sex couples the right to marry is a clear violation of equal protection under the law.</p>

    <p><strong>Legality and Crime</strong><br>
    Description: The constraints imposed on or freedoms granted to individuals, government, and corporations via laws, the Constitution, and judicial interpretation. Includes enforcement of laws, breaking laws, crime rates, sentencing, punishment, and legal consequences. Covers both the authority to regulate and the actual application/violation of rules.<br>
    Example: The Supreme Court ruled that bans on same-sex marriage are unconstitutional and violate civil liberties.</p>

    <p><strong>Health and Safety</strong><br>
    Description: Healthcare access and effectiveness, illness, disease, sanitation, obesity, mental health effects, prevention of or perpetuation of gun violence, infrastructure and building safety.<br>
    Example: Allowing same-sex marriage is an endorsement of unsafe sexual practices and will contribute to the spread of disease.</p>

    <p><strong>Cultural Identity</strong><br>
    Description: The social norms, trends, values and customs constituting culture(s).<br>
    Example: Same-sex marriage threatens the traditional concept of family that our culture has upheld for generations.</p>

    <p><strong>Public Opinion</strong><br>
    Description: References to general social attitudes, polling and demographic information, as well as implied or actual consequences of diverging from or "getting ahead of" public opinion or polls.<br>
    Example: A recent poll shows that 65% of Americans now support same-sex marriage, up from 30% a decade ago.</p>

    <p><strong>Security and Defense</strong><br>
    Description: Concerns related to safety, protection from threats or of one's person, national security, border security, and measures taken to ensure stability and defense.<br>
    Example: Same-sex marriage could undermine traditional social structures and thus contribute to community stability and security.</p>

    <p><strong>Political and Policies</strong><br>
    Description: Any political considerations and discourse surrounding an issue, as well as policies including partisan dynamics, lobbyist involvement, bipartisan efforts, political maneuvering, vote trading, and legislative processes.<br>
    Example: The governor vetoed a bill legalizing same-sex marriage, citing pressure from conservative lawmakers.</p>

    <p><strong>None</strong><br>
    Description: If the sentence is not framed in any of the proposed labels above, please select this label.<br>

    <h3>üìö Annotation Examples</h3>

    <div class="example-container">
      <strong>Example 1: Economic Framing</strong>
      <div class="example-sentence">
        "Government spending in and of itself is not a bad thing."
      </div>
      <div class="example-labels">
        <span class="example-label economic">Economic</span>
      </div>
      <div class="example-explanation">
        <strong>Analysis:</strong> This sentence clearly frames an issue through an economic lens by directly discussing government spending and its financial implications. It presents a monetary/financial perspective on policy, which is the core of economic framing.
      </div>
    </div>

    <div class="example-container">
      <strong>Example 2: Legality and Crime Framing</strong>
      <div class="example-sentence">
        "Deliberate destruction of subpoenaed evidence is felony obstruction of justice."
      </div>
      <div class="example-labels">
        <span class="example-label legality-crime">Legality and Crime</span>
      </div>
      <div class="example-explanation">
        <strong>Analysis:</strong> This sentence frames the issue through legal constraints and criminal law by referencing specific legal violations, criminal charges, and judicial processes. It focuses on law enforcement and legal consequences.
      </div>
    </div>

    <div class="example-container">
      <strong>Example 3: Public Opinion Framing</strong>
      <div class="example-sentence">
        "A 2010 QMI poll found that 71.6 per cent of Canadians outside Quebec say they're very attached to Canada."
      </div>
      <div class="example-labels">
        <span class="example-label public-opinion">Public Opinion</span>
      </div>
      <div class="example-explanation">
        <strong>Analysis:</strong> This sentence frames an issue through public opinion by directly citing polling data and demographic information about social attitudes.
      </div>
    </div>

  </div>
</div>

<input type="hidden" id="annotator-id" />
<input type="hidden" id="dataset-name" />

<div id="sentence">Loading sentence...</div>

<div id="labels">
  <input type="checkbox" id="Economic" />
  <label for="Economic">Economic</label>

  <input type="checkbox" id="Legality_Crime" />
  <label for="Legality_Crime">Legality-Crime</label>

  <input type="checkbox" id="Health_Safety" />
  <label for="Health_Safety">Health and Safety</label>

  <input type="checkbox" id="Fairness_Equality" />
  <label for="Fairness_Equality">Fairness and Equality</label>

  <input type="checkbox" id="Security_Defense" />
  <label for="Security_Defense">Security and Defense</label>

  <input type="checkbox" id="Public_Opinion" />
  <label for="Public_Opinion">Public Opinion</label>

  <input type="checkbox" id="Morality" />
  <label for="Morality">Morality</label>

  <input type="checkbox" id="Political_Policies" />
  <label for="Political_Policies">Political and Policies</label>

  <input type="checkbox" id="Cultural_Identity" />
  <label for="Cultural_Identity">Cultural Identity</label>

  <div class="none-container">
    <input type="checkbox" id="None" />
    <label for="None">None</label>
  </div>

</div>
<!-- Tutorial-specific buttons -->
<button id="checkAnswerBtn" style="display: none;">Check Answer</button>
<button id="nextExampleBtn" style="display: none;">Next Example</button>

<!-- Main annotation navigation buttons -->
<button id="prevBtn" style="display: none;">Previous</button>
<button id="nextBtn" style="display: none;">Next</button>

<!-- Start Annotation button -->
<button id="startAnnotationBtn" style="display: none;">Start Annotation</button>

<div id="status"></div>

<script>
  const SENTENCES_PER_ANNOTATOR = 100;

  window.onload = function() {
    if (localStorage.getItem('instructionsRead') === 'true') {
      // Clear the flag so it only works once
      localStorage.removeItem('instructionsRead');
      // Start the tutorial immediately
      startTutorial();
    } else {
      // Show the name input modal as before
      document.getElementById('name-modal').style.display = 'flex';
    }
  }
  let sentences = [];
  let currentIndex = 0;
  let annotations = {};
  let annotatorId = null;
  let datasetFile = null;
  let annotatorName = null;
  let inTutorial = false;
  let tutorialIndex = 0;
  
  const tutorialExamples = [
    {
      sentence: "Government spending in and of itself is not a bad thing.",
      correctLabels: ["Economic"],
      explanation: "This sentence clearly frames an issue through an economic lens by directly discussing government spending and its financial implications. It presents a monetary/financial perspective on policy, which is the core of economic framing."
    },
    {
      sentence: "Deliberate destruction of subpoenaed evidence is felony obstruction of justice.",
      correctLabels: ["Legality_Crime"],
      explanation: "This sentence frames the issue through legal constraints and criminal law by referencing specific legal violations, criminal charges, and judicial processes. It focuses on law enforcement and legal consequences."
    },
    {
      sentence: "A 2010 QMI poll found that 71.6 per cent of Canadians outside Quebec say they're very attached to Canada.",
      correctLabels: ["Public_Opinion"],
      explanation: "This sentence frames an issue through public opinion by directly citing polling data and demographic information about social attitudes."
    }
  ];

  // Function to open modal with framing categories
  function openModal() {
    document.getElementById('modal').style.display = 'block';
  }

  // Function to close modal
  function closeModal() {
    document.getElementById('modal').style.display = 'none';
  }

  // Close modal when clicking outside of it
  window.onclick = function(event) {
    const modal = document.getElementById('modal');
    if (event.target === modal) {
      closeModal();
    }
  };

  async function startAnnotation() {
      annotatorName = document.getElementById('annotator-name').value.trim();
      if (!annotatorName) {
          alert("Please enter your name.");
          return;
      }
      
      document.getElementById('name-modal').style.display = 'none';
      startTutorial();
  }

  function startTutorial() {
      inTutorial = true;
      tutorialIndex = 0;
      document.getElementById("status").innerHTML = `<strong>üìö Let's practice with some examples before starting annotation!`;
      displayTutorialExample();
  }

  function displayTutorialExample() {
      const example = tutorialExamples[tutorialIndex];
      document.getElementById("sentence").innerText = example.sentence;
      
      // Clear all checkboxes
      const labels = getAllLabels();
      labels.forEach(label => {
        const el = document.getElementById(label);
        if (el) el.checked = false;
      });
      
      // Clear the explanation text
      document.getElementById("status").innerText = "";

      // Show tutorial-specific buttons
      document.getElementById("checkAnswerBtn").style.display = "inline-block";
      document.getElementById("nextExampleBtn").style.display = "none";
      document.getElementById("prevBtn").style.display = "none"; // Hide "Previous" button
      document.getElementById("nextBtn").style.display = "none"; // Hide "Next" button
      document.getElementById("startAnnotationBtn").style.display = "none";
  }

  function checkTutorialAnswer() {
      const example = tutorialExamples[tutorialIndex];
      const selectedLabels = getAllLabels().filter(label => {
          const el = document.getElementById(label);
          return el && el.checked;
      });
      
      const correctLabels = example.correctLabels;
      const isCorrect = selectedLabels.length === correctLabels.length && 
                      selectedLabels.every(label => correctLabels.includes(label));
      
      if (isCorrect) {
          document.getElementById("status").innerHTML = `<span style="color: green;">‚úÖ Correct!</span> ${example.explanation}`;
      } else {
          document.getElementById("status").innerHTML = `<span style="color: red;">‚ùå Not quite right.</span> The correct answer is: <strong>${correctLabels.join(", ")}</strong><br>${example.explanation}`;
          
          // Show correct answer
          const labels = getAllLabels();
          labels.forEach(label => {
              const el = document.getElementById(label);
              if (el) el.checked = correctLabels.includes(label);
          });
      }
      
      // Show the "Next Example" button or "Start Annotation" for the last example
      if (tutorialIndex < tutorialExamples.length - 1) {
          document.getElementById("nextExampleBtn").style.display = "inline-block";
      } else {
          document.getElementById("startAnnotationBtn").style.display = "inline-block";
      }
      document.getElementById("checkAnswerBtn").style.display = "none";
  }

  function nextTutorialExample() {
      if (tutorialIndex < tutorialExamples.length - 1) {
          tutorialIndex++;
          displayTutorialExample();
      } else {
          finishTutorial();
      }
  }

  function finishTutorial() {
      inTutorial = false; // Set the tutorial flag to false

      // Hide tutorial-specific buttons
      document.getElementById("checkAnswerBtn").style.display = "none";
      document.getElementById("nextExampleBtn").style.display = "none";
      document.getElementById("startAnnotationBtn").style.display = "none";

      // Display completion message
      document.getElementById("status").innerHTML = `<strong>üéØ Great job! Tutorial complete.</strong> Now you'll begin the real annotation task! Loading...`;

      // Wait for 6 seconds before transitioning to the main annotation session
      setTimeout(() => {
          // Show main annotation navigation buttons
          document.getElementById("prevBtn").style.display = "inline-block";
          document.getElementById("nextBtn").style.display = "inline-block";

          // Initialize the annotation session
          initializeSession();
      }, 10000); // 6000 milliseconds = 6 seconds
  }

  document.getElementById("checkAnswerBtn").addEventListener("click", checkTutorialAnswer);
  document.getElementById("nextExampleBtn").addEventListener("click", nextTutorialExample);
  document.getElementById("startAnnotationBtn").addEventListener("click", finishTutorial);

  async function initializeSession() {
      try {
          console.log("Initializing session...");
          const res = await fetch(`/start_annotation?name=${encodeURIComponent(annotatorName)}`);
          if (!res.ok) throw new Error("Failed to start annotation session");
          const sessionData = await res.json();
          console.log("Session data:", sessionData);
          annotatorId = sessionData.annotator_id;
          document.getElementById("annotator-id").value = annotatorId;
          document.getElementById("dataset-name").value = `${sessionData.total_sentences} sentences (${sessionData.overlap_sentences} overlap + ${sessionData.unique_sentences} unique)`;
          // Now load sentences
          await loadSentences();
      } catch (error) {
          console.error("Error in initializeSession:", error);
          document.getElementById("sentence").innerText = "Error starting annotation session.";
      }
  }

  async function loadSentences() {
      try {
          console.log("Loading sentences...");
          const res = await fetch(`/api/sentences?annotator_id=${annotatorId}`);
          if (!res.ok) throw new Error("Failed to load sentences");
          sentences = await res.json();
          console.log("Loaded sentences:", sentences);
          if (!sentences.length) {
              document.getElementById("sentence").innerText = "No sentences loaded.";
              return;
          }
          displaySentence();
      } catch (error) {
          console.error("Error in loadSentences:", error);
          document.getElementById("sentence").innerText = "Error loading sentences.";
      }
  }

  function displaySentence() {
      const sentence = sentences[currentIndex].sentence_text;
      document.getElementById("sentence").innerText = sentence;

      const ann = annotations[currentIndex] || {};
      const labels = getAllLabels();
      labels.forEach(label => {
        const el = document.getElementById(label);
        if (el) el.checked = ann[label] || false;
      });

      document.getElementById("status").innerText = `Sentence ${currentIndex + 1} of ${SENTENCES_PER_ANNOTATOR}`;
  }

  // Get current labels checked as object
  function gatherCurrentAnnotation() {
    const labels = getAllLabels();
    const ann = {};
    labels.forEach(label => {
      const el = document.getElementById(label);
      ann[label] = el ? el.checked : false;
    });
    return ann;
  }

  async function saveAnnotation() {
      const labelAnnotation = gatherCurrentAnnotation();
      annotations[currentIndex] = labelAnnotation;
      
      const payload = {
          annotator_id: annotatorId,
          annotator_name: annotatorName,
          sentence: sentences[currentIndex].sentence_text,
          label: labelAnnotation
      };
      
      try {
          document.getElementById("status").innerText = "Saving annotation...";
          const res = await fetch("/api/save_annotation", {
              method: "POST",
              headers: {
                  "Content-Type": "application/json"
              },
              body: JSON.stringify(payload),
          });
          if (!res.ok) {
              throw new Error("Failed to save annotation");
          }
          document.getElementById("status").innerText = `Annotation saved (Sentence ${currentIndex + 1})`;
      } catch (error) {
          console.error(error);
          document.getElementById("status").innerText = "Error saving annotation. Please try again.";
      }
  }

  function getAllLabels() {
    return [
      "Economic",
      "Legality_Crime",
      "Health_Safety",
      "Fairness_Equality",
      "Security_Defense",
      "Public_Opinion",
      "Morality",
      "Political_Policies",
      "Cultural_Identity",
      "None"
    ];
  }

  // Handle "None" checkbox logic
  document.getElementById("None").addEventListener("change", function () {
    if (this.checked) {
      getAllLabels().forEach(label => {
        if (label !== "None") {
          const el = document.getElementById(label);
          if (el) el.checked = false;
        }
      });
    }
  });

  // Handle other checkboxes unchecking "None"
  getAllLabels().forEach(label => {
    const el = document.getElementById(label);
    if (el && label !== "None") {
      el.addEventListener("change", function () {
        if (this.checked) {
          document.getElementById("None").checked = false;
        }
      });
    }
  });

  async function nextSentence() {
      if (inTutorial) {
          checkTutorialAnswer();
          return;
      }
      
      await saveAnnotation();

      if (currentIndex < SENTENCES_PER_ANNOTATOR - 1) {
          currentIndex++;
          displaySentence();
      } else {
          document.getElementById("sentence").innerText = "üéâ You have finished annotating all sentences. üéâ Thank you! You may now close this window.";
          document.getElementById("labels").style.display = "none";
          document.getElementById("nextBtn").style.display = "none";
          document.getElementById("prevBtn").style.display = "none";
          document.getElementById("status").innerText = "";
      }
  }

  async function prevSentence() {
    if (inTutorial) {
        if (tutorialIndex > 0) {
            tutorialIndex--;
            displayTutorialExample();
        }
        return;
    }
    
    await saveAnnotation();
    if (currentIndex > 0) {
      currentIndex--;
      displaySentence();
    }
  }

  document.getElementById("nextBtn").addEventListener("click", nextSentence);
  document.getElementById("prevBtn").addEventListener("click", prevSentence);

  // Start the application
  // initializeSession();
</script>
</body>
</html>